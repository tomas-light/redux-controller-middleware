{"version":3,"file":"ControllerBase.js","sourceRoot":"","sources":["../../redux-controller-middleware/src/ControllerBase.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,uCAAkC;AAElC,oDAAmD;AAEnD,+DAAyD;AAGlD,IAAM,cAAc,sBAApB,MAAM,cAAc;IAQN;IALA,QAAQ,CAA4B;IACpC,QAAQ,CAAc;IAEzC,YACE,UAA6B,EACZ,UAA4C;QAA5C,eAAU,GAAV,UAAU,CAAkC;QAE7D,IAAI,GAAG,CAAC,MAAM,KAAK,gBAAc,EAAE,CAAC;YAClC,MAAM,IAAI,KAAK,CAAC,mDAAmD,CAAC,CAAC;QACvE,CAAC;QAED,IAAI,CAAC,QAAQ,GAAG,UAAU,EAAE,QAAQ,CAAC;QACrC,IAAI,CAAC,QAAQ,GAAG,GAAG,EAAE,CAAC,UAAU,EAAE,QAAQ,EAAE,CAAC;IAC/C,CAAC;IAES,gBAAgB,CAAC,YAAyC;QAClE,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;YACrB,MAAM,IAAI,KAAK,CAAC,gGAAgG,CAAC,CAAC;QACpH,CAAC;QAED,IAAI,CAAC,QAAQ,CAAC,IAAA,sCAAgB,EAAC,IAAI,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;IACjE,CAAC;CACF,CAAA;AAzBY,wCAAc;yBAAd,cAAc;IAD1B,IAAA,iBAAM,EAAC,qBAAU,CAAC;GACN,cAAc,CAyB1B","sourcesContent":["import { inject } from 'cheap-di';\nimport { Dispatch } from 'redux';\nimport { Middleware } from './middleware/index.js';\nimport { Action, Constructor, Controller } from './types/index.js';\nimport { updateStoreSlice } from './updateStoreSlice.js';\n\n@inject(Middleware)\nexport class ControllerBase<StoreSliceInstance, State extends Record<string, unknown> = Record<string, unknown>>\n  implements Controller<State>\n{\n  protected readonly dispatch: Dispatch<Action<unknown>>;\n  protected readonly getState: () => State;\n\n  constructor(\n    middleware: Middleware<State>,\n    private readonly storeSlice?: Constructor<StoreSliceInstance>\n  ) {\n    if (new.target === ControllerBase) {\n      throw new Error('Cannot construct ControllerBase instance directly');\n    }\n\n    this.dispatch = middleware?.dispatch;\n    this.getState = () => middleware?.getState();\n  }\n\n  protected updateStoreSlice(partialStore: Partial<StoreSliceInstance>) {\n    if (!this.storeSlice) {\n      throw new Error('You have to pass storeSlice to ControllerBase\\'s \"super\" to use \"this.updateStoreSlice\" method');\n    }\n\n    this.dispatch(updateStoreSlice(this.storeSlice)(partialStore));\n  }\n}\n"]}